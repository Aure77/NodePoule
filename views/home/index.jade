extends ../layout

block home
  div(data-ng-controller='tournamentCtrl')
    h2 Annonces
      |         
      p(class='no-tournaments', data-ng-hide="tournaments.length") Aucune annonce pour le moment.
      #myCarousel.carousel.slide(data-ride='carousel', data-ng-if="tournaments.length")
        ol.carousel-indicators
          li(data-ng-repeat="tournament in tournaments track by $index" data-ng-class="{'active': $index==0}", data-ng-attr-data-target='#myCarousel', data-ng-attr-data-slide-to='{$index}')
        .carousel-inner(role='listbox')
          div(data-ng-repeat="tournament in tournaments track by $index" data-ng-class="{'active': $index==0}")
            a(data-ng-href='/tournaments/{{tournament.id}}', data-ng-title='{{tournament.title}}')
              img.first-slide.img-responsive.center-block(data-ng-src='{{tournament.imageRelPath}}', data-ng-alt='{{tournament.title}}')
        a.left.carousel-control(href='#myCarousel', role='button', data-slide='prev')
          span.glyphicon.glyphicon-chevron-left(aria-hidden='true')
          |             
          span.sr-only Previous
        |           
        a.right.carousel-control(href='#myCarousel', role='button', data-slide='next')
          span.glyphicon.glyphicon-chevron-right(aria-hidden='true')
          |             
          span.sr-only Next
    .wrapper
      figure.img-indent2
        img(src='/images/page1-img1.png', alt='')
      .extra-wrap
        strong.text-1.
          N'hésitez pas à vous inscrire sur le forum pour échanger avec vos adversaires.

block aside

block content
  .row
    // Left pannel
    .col-md-8.left-panel
      section(data-ng-controller='newsCtrl')
        h3 Les news
        |                     
        p.no-tournaments(data-ng-hide="newsCollection.length") Aucune news n'est disponible.
        .news-list(data-ng-if="newsCollection.length")
          article.news-container.container-fluid(data-ng-repeat="news in newsCollection track by $index")
              .news-img.col-md-4
                img(data-ng-src='{{news.thumbnailRelPath}}', data-ng-alt='{{news.title}}')
              |                                 
              .col-md-8
                a.news-title(data-ng-href='/news/{{news.id}}') {{news.title}}
                |                                   
                .news-content
                  | {{news.content}}
          | 
        -//.news-paginate
           -//include _paginate
    // Right pannel
    .col-md-4.right-panel
      aside
        h3 Tournois
        |                 
        a.filter(href='#') En ce moment
        | /
        a.filter(href='#') Populaires
        | /
        a.filter(href='#') A venir
        | /
        a.filter(href='#') J&apos;y participe
        |                 
        ul.tournaments
          li.row
            img.img-responsive.pull-left(src='/images/hearthstone_icon.png')
            a.pull-left(href='#') Tournoi 1
            img.img-responsive.pull-left(alt='inscriptions closes', src='/images/lock.png')
          |                     
          li.row
            img.img-responsive.pull-left(src='/images/hearthstone_icon.png')
            a.pull-left(href='#') Tournoi 1
            img.img-responsive.pull-left(alt='inscriptions closes', src='/images/lock.png')
          |                     
          li.row
            img.img-responsive.pull-left(src='/images/hearthstone_icon.png')
            a.pull-left(href='#') Tournoi 1
            img.img-responsive.pull-left(alt='inscriptions closes', src='/images/lock.png')
          |                     
          li.row
            img.img-responsive.pull-left(src='/images/hearthstone_icon.png')
            a.pull-left(href='#') Tournoi 1
            img.img-responsive.pull-left(alt='inscriptions closes', src='/images/lock.png')
      |             
      aside
        h3 Feeds
        ul#feeds
      aside
        img(src='/images/banner_design.png', alt='ads')

block js
  script(type='text/javascript', src='/js/jquery.feeds.min.js')
  script(type='text/javascript').
    $(function() {
      $('ul#feeds').feeds({
          feeds: {
              recent: '#{sails.config.nodepoule.forumUrl}/recent.rss',
          },
          entryTemplate: function(entry) {
              return '<li><a href="' + entry.link + '">' + entry.title + '</a></li>';
          }
      });
    });
  script(type='text/javascript', src='https://ajax.googleapis.com/ajax/libs/angularjs/1.4.9/angular.js')
  script(type='text/javascript').
    var app = angular.module('npApp', []);
    app.controller('tournamentCtrl', function ($scope, $http, $timeout) {
      $scope.tournaments = [];
      $scope.getAllTournaments = function(callback) {
        $http.get("/api/rest/tournament").success(function(response) {
          $scope.tournaments = response;
          if(typeof callback === "function") {
            callback();
          }
        });
      };
      $scope.getAllTournaments();
    });
    app.controller('newsCtrl', function ($scope, $http, $timeout) {
      $scope.newsCollection = [];
      $scope.getAllNews = function(callback) {
        $http.get("/api/rest/news").success(function(response) {
          $scope.newsCollection = response;
          if(typeof callback === "function") {
            callback();
          }
        });
      };
      $scope.getAllNews();
    });
